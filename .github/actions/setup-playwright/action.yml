description: Provides Common Setup for Workflows Dependent on Playwright
name: setup-playwright

runs:
  using: composite
  steps:
    - run: |
        PLAYWRIGHT_VERSION=`yarn info @playwright/test --name-only | cut -d @ -f 3 | cut -d : -f 2`
        echo "PLAYWRIGHT_VERSION=$PLAYWRIGHT_VERSION" >> $GITHUB_ENV
      id: playwright-version
      shell: sh
    - uses: actions/cache@88522ab9f39a2ea568f7027eddc7d8d8bc9d59c8 # v3.3.1
      id: playwright-binaries
      env:
        PLAYWRIGHT_VERSION: env.PLAYWRIGHT_VERSION
      with:
        key: ${{ runner.os }}-playwright-binaries-${{ env.PLAYWRIGHT_VERSION }}
        path: ~/.cache/ms-playwright
    - run: yarn playwright install --with-deps
      if: steps.playwright-binaries.outputs.cache-hit != 'true'
      shell: sh
